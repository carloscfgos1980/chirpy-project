# Deete a chirp using DELETE method

1. <sql/queries/chirps.sql> Querie to delete a chirp:

-- name: DeleteChirp :exec
DELETE FROM chirps
WHERE id = $1;


2. Run the command to create the code from server as root: 
sqlc generate

3. <handler_chirps_delete.go>. Function to delete a chirp. We need to check if the user is the author from the chirp before delete it:


func (cfg *apiConfig) handlerChirpsDelete(w http.ResponseWriter, r*http.Request) {

3.1 Get the chirpId
 chirpIDString := r.PathValue("chirpID")

3.2 Parse the chirpId:

 chirpID, err := uuid.Parse(chirpIDString)
 if err != nil {
  respondWithError(w, http.StatusBadRequest, "Invalid chirp ID", err)
  return
 }

3.4 Get the token:

 token, err := auth.GetBearerToken(r.Header)
 if err != nil {
  respondWithError(w, http.StatusUnauthorized, "Couldn't find JWT", err)
  return
 }

3.5 Get the userId thru the token:

 userID, err := auth.ValidateJWT(token, cfg.jwtSecret)
 if err != nil {
  respondWithError(w, http.StatusUnauthorized, "Couldn't validate JWT", err)
  return
 }

3.5 Get chirp from database:

 dbChirp, err := cfg.db.GetChirp(r.Context(), chirpID)
 if err != nil {
  respondWithError(w, http.StatusNotFound, "Couldn't get chirp", err)
  return
 }

3.6 Check if the logged user is the same userId of the chirp:

 if dbChirp.UserID != userID {
  respondWithError(w, http.StatusForbidden, "You can't delete this chirp", err)
  return
 }

3.7 Delete the chirp

 err = cfg.db.DeleteChirp(r.Context(), chirpID)
 if err != nil {
  respondWithError(w, http.StatusInternalServerError, "Couldn't delete chirp", err)
  return
 }

3.8 Response with 204 status
 w.WriteHeader(http.StatusNoContent)
}
